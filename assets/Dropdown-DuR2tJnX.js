import{A as W}from"./AlertIcon-4RZPqScJ.js";import{c as E,e as T,h as u,t as P,r as w,w as c,o as _,j as z,m as B,n as L,q as y,s as I,v as N,E as j,p as U,aN as A,aO as R,ap as $,y as D,z as o,a8 as q,x as K,aP as F,ac as G,aK as H,a5 as M,_ as J}from"./index-D6uV4iv9.js";const Q=E({__name:"Dropdown",props:{miniWidget:{}},setup(C){var g,V;const i=T();let s;const d=C,l=u(()=>{var e;return((e=a.value.options.layout)==null?void 0:e.selectorOptions)||[]}),a=P(d).miniWidget,m=w(l.value.find(e=>{var t;return e.value===((t=d.miniWidget.options.lastSelected)==null?void 0:t.value)})||l.value[0]),n=w(((g=d.miniWidget.options.lastSelected)==null?void 0:g.value)||((V=l.value[0])==null?void 0:V.value));c(()=>i.miniWidgetManagerVars(a.value.hash).configMenuOpen,e=>{e===!0&&(i.showElementPropsDrawer(a.value.hash),setTimeout(()=>{i.miniWidgetManagerVars(a.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0}),c(m,e=>{i.updateElementOptions(a.value.hash,{...a.value.options,lastSelected:e})});const S=e=>{if(i.editingMode)return;const t=l.value.find(r=>r.value===e);t&&(n.value=e,a.value.options.dataLakeVariable&&F(a.value.options.dataLakeVariable.id,e),i.setMiniWidgetLastValue(a.value.hash,t.value))},p=u(()=>{var e;return!!((e=a.value.options.dataLakeVariable)!=null&&e.id)}),x=u(()=>{var e;return((e=a.value.options.dataLakeVariable)==null?void 0:e.allowUserToChangeValue)===!0}),h=u(()=>{var e;return!!((e=a.value.options.dataLakeVariable)!=null&&e.id)&&x.value&&!i.editingMode}),f=()=>{a.value.options.dataLakeVariable&&(s=G(a.value.options.dataLakeVariable.id,e=>{n.value=String(e)}),n.value=String(H(a.value.options.dataLakeVariable.id)))};return c(()=>{var e;return(e=a.value.options.dataLakeVariable)==null?void 0:e.id},(e,t)=>{t&&s&&M(t,s),e&&f()}),_(()=>{if((!a.value.options||Object.keys(a.value.options).length===0)&&(a.value.isCustomElement=!0,i.updateElementOptions(a.value.hash,{layout:{selectorOptions:[],align:"start",width:168},variableType:"string",dataLakeVariable:void 0})),a.value.options.dataLakeVariable)f();else{const e=i.getMiniWidgetLastValue(a.value.hash);m.value=l.value.find(t=>t.value===e)||l.value[0]}}),z(()=>{a.value.options.dataLakeVariable&&s&&M(a.value.options.dataLakeVariable.id,s)}),(e,t)=>{var r,b;return L(),B("div",{class:D(["flex relative w-full",((r=o(i).elementToShowOnDrawer)==null?void 0:r.hash)===o(a).hash&&o(i).editingMode?"bg-[#00000010] ":"border-0"]),style:K({width:"100%",justifyContent:(b=o(a).options.layout)==null?void 0:b.align}),onClick:t[2]||(t[2]=v=>o(i).editingMode&&o(i).showElementPropsDrawer(o(a).hash))},[y(q,{text:"This element is on display mode. To make it interactive, create or select a different data-lake variable",location:"top","open-delay":"500",disabled:h.value||!p.value},{activator:j(({props:v})=>{var k;return[U("div",A(R(v)),[y($,{modelValue:n.value,"onUpdate:modelValue":[t[0]||(t[0]=O=>n.value=O),S],items:l.value,"item-title":"name","item-value":"value",theme:"dark",density:"compact",variant:"filled","min-width":((k=o(a).options.layout)==null?void 0:k.width)||168,"hide-details":"",class:D(["text-white",[h.value?"pointer-events-auto cursor-pointer":"pointer-events-none cursor-default",p.value?"":"opacity-50"]])},null,8,["modelValue","items","min-width","class"])],16)]}),_:1},8,["disabled"]),p.value?N("",!0):(L(),I(W,{key:0,icon:"mdi-connection",color:"#b9af1d",animation:"pulse",class:"absolute center ml-[70px] mt-[12px]",tooltip:"This element isn't connected to a data-lake variable yet. Click here to configure it.",onClick:t[1]||(t[1]=v=>o(i).showElementPropsDrawer(o(a).hash))}))],6)}}}),Z=J(Q,[["__scopeId","data-v-18b55b9d"]]);export{Z as default};
