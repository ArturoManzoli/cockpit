import{A as O}from"./AlertIcon-BBNB53hE.js";import{c as W,e as C,h as v,t as x,r as k,w as c,o as E,j as T,m as _,n as w,p as B,s as j,v as z,q as I,y as L,z as l,ap as N,x as P,aO as U,ac as A,aK as R,a5 as y,_ as $}from"./index-C8maa8ku.js";const q=W({__name:"Dropdown",props:{miniWidget:{}},setup(D){var g,f;const i=C();let o;const d=D,n=v(()=>{var a;return((a=e.value.options.layout)==null?void 0:a.selectorOptions)||[]}),e=x(d).miniWidget,m=k(n.value.find(a=>{var t;return a.value===((t=d.miniWidget.options.lastSelected)==null?void 0:t.value)})||n.value[0]),s=k(((g=d.miniWidget.options.lastSelected)==null?void 0:g.value)||((f=n.value[0])==null?void 0:f.value));c(()=>i.miniWidgetManagerVars(e.value.hash).configMenuOpen,a=>{a===!0&&(i.showElementPropsDrawer(e.value.hash),setTimeout(()=>{i.miniWidgetManagerVars(e.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0}),c(m,a=>{i.updateElementOptions(e.value.hash,{...e.value.options,lastSelected:a})});const M=a=>{if(i.editingMode)return;const t=n.value.find(r=>r.value===a);t&&(s.value=a,e.value.options.dataLakeVariable&&U(e.value.options.dataLakeVariable.id,a),i.setMiniWidgetLastValue(e.value.hash,t.value))},u=v(()=>{var a;return((a=e.value.options.dataLakeVariable)==null?void 0:a.id)||i.editingMode}),S=v(()=>{var a;return(a=e.value.options.dataLakeVariable)==null?void 0:a.allowUserToChangeValue}),h=()=>{e.value.options.dataLakeVariable&&(o=A(e.value.options.dataLakeVariable.id,a=>{s.value=String(a)}),s.value=String(R(e.value.options.dataLakeVariable.id)))};return c(()=>{var a;return(a=e.value.options.dataLakeVariable)==null?void 0:a.id},(a,t)=>{t&&o&&y(t,o),a&&h()}),E(()=>{if((!e.value.options||Object.keys(e.value.options).length===0)&&(e.value.isCustomElement=!0,i.updateElementOptions(e.value.hash,{layout:{selectorOptions:[],align:"start",width:168},variableType:"string",dataLakeVariable:void 0})),e.value.options.dataLakeVariable)h();else{const a=i.getMiniWidgetLastValue(e.value.hash);m.value=n.value.find(t=>t.value===a)||n.value[0]}}),T(()=>{e.value.options.dataLakeVariable&&o&&y(e.value.options.dataLakeVariable.id,o)}),(a,t)=>{var r,V,b;return w(),_("div",{class:L(["flex relative w-full",((r=l(i).elementToShowOnDrawer)==null?void 0:r.hash)===l(e).hash&&l(i).editingMode?"bg-[#00000010] ":"border-0"]),style:P({width:"100%",justifyContent:(V=l(e).options.layout)==null?void 0:V.align}),onClick:t[2]||(t[2]=p=>l(i).editingMode&&l(i).showElementPropsDrawer(l(e).hash))},[B("div",null,[I(N,{modelValue:s.value,"onUpdate:modelValue":[t[0]||(t[0]=p=>s.value=p),M],items:n.value,"item-title":"name","item-value":"value",theme:"dark",density:"compact",disabled:l(i).editingMode||!u.value||!S.value,variant:"filled","min-width":((b=l(e).options.layout)==null?void 0:b.width)||168,"hide-details":"",class:L(["text-white",{"opacity-30":!u.value}])},null,8,["modelValue","items","disabled","min-width","class"])]),u.value?z("",!0):(w(),j(O,{key:0,icon:"mdi-connection",color:"#b9af1d",animation:"pulse",class:"absolute center ml-10 mt-[10px]",tooltip:"This element isn't connected to a data-lake variable yet. Right click and select options to configure it.",onClick:t[1]||(t[1]=p=>l(i).showElementPropsDrawer(l(e).hash))}))],6)}}}),G=$(q,[["__scopeId","data-v-60b6b43e"]]);export{G as default};
