import{c as ee,y as ae,J as te,r as w,w as A,o as ne,k as oe,h as le,l as v,m as x,n as p,v as L,O as N,q as i,s as h,az as K,t as ie,G as se,at as ue,I as P,N as j,Q as U,af as X,ax as re,aw as F,ay as de,_ as me}from"./index-DgVZlBxX.js";const ce={class:"potentiometer-scale elevation-5"},ve={key:0,class:"absolute bg-[#880000] pa-2 text-xs mt-2 -ml-12 border-2 border-white rounded-md z-50"},pe={class:"flex flex-col w-4 h-7 justify-between items-center"},Ve=ee({__name:"Dial",props:{miniWidget:{}},setup(Y){const o=ae(),e=te(Y).miniWidget,l=w(0),y=w(-150);let D;const d=w(!1),k=w(String(Math.round(l.value)||0));A(()=>o.miniWidgetManagerVars(e.value.hash).configMenuOpen,a=>{a===!0&&(o.showElementPropsDrawer(e.value.hash),setTimeout(()=>{o.miniWidgetManagerVars(e.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const V=a=>{var g,c,m;let t;a==null||isNaN(Number(a))?t=((g=e.value.options.layout)==null?void 0:g.minValue)||0:t=Number(a),l.value=t;const n=300,s=((c=e.value.options.layout)==null?void 0:c.minValue)||0,u=(((m=e.value.options.layout)==null?void 0:m.maxValue)||100)-s;y.value=(t-s)/u*n-150},_=()=>{var a;if(e.value.options.dataLakeVariable){D=re((a=e.value.options.dataLakeVariable)==null?void 0:a.name,n=>{V(n)});const t=o.getMiniWidgetLastValue(e.value.hash);V(t)}};A(()=>{var a;return(a=e.value.options.dataLakeVariable)==null?void 0:a.name},a=>{a&&_()},{immediate:!0}),A(()=>{var a,t;return[(a=e.value.options.layout)==null?void 0:a.minValue,(t=e.value.options.layout)==null?void 0:t.maxValue]},()=>{var a;l.value=((a=e.value.options.layout)==null?void 0:a.minValue)||0,V(l.value)},{immediate:!0}),ne(()=>{(!e.value.options||Object.keys(e.value.options).length===0)&&(e.value.isCustomElement=!0,o.updateElementOptions(e.value.hash,{layout:{minValue:0,maxValue:100,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",dataLakeVariable:void 0})),_()});const $=oe(()=>{var a;switch((a=e.value.options.layout)==null?void 0:a.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}});let C=0,E=0;const q=a=>{a.preventDefault();const n=a.currentTarget.getBoundingClientRect(),s=n.left+n.width/2,r=n.top+n.height/2,u=Math.atan2(a.clientY-r,a.clientX-s)*180/Math.PI;C=u,E=u;const c=y.value-u,m=z=>{var I,O;const R=Math.atan2(z.clientY-r,z.clientX-s)*180/Math.PI;let b=R-C;b>180?b-=360:b<-180&&(b+=360);const S=E+b;C=R,E=S;let M=S+c;M=Math.max(-150,Math.min(150,M)),y.value=M;const H=300,B=((I=e.value.options.layout)==null?void 0:I.minValue)||0,Z=(((O=e.value.options.layout)==null?void 0:O.maxValue)||100)-B;if(l.value=(M+150)/H*Z+B,e.value.options.dataLakeVariable){if(o.editingMode)return;const T=Math.round(l.value);o.setMiniWidgetLastValue(e.value.hash,T),F(e.value.options.dataLakeVariable.name,T)}},f=()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f)};document.addEventListener("mousemove",m),document.addEventListener("mouseup",f)},G=()=>{var t;const a=((t=e.value.options.layout)==null?void 0:t.maxValue)||100;if(l.value<a&&(V(l.value+1),e.value.options.dataLakeVariable&&!o.editingMode)){const n=Math.round(l.value);o.setMiniWidgetLastValue(e.value.hash,n),F(e.value.options.dataLakeVariable.name,n)}},J=()=>{var t;const a=((t=e.value.options.layout)==null?void 0:t.minValue)||0;if(l.value>a&&(V(l.value-1),e.value.options.dataLakeVariable&&!o.editingMode)){const n=Math.round(l.value);o.setMiniWidgetLastValue(e.value.hash,n),F(e.value.options.dataLakeVariable.name,n)}},Q=()=>{o.editingMode||(d.value=!0,k.value=String(Math.round(l.value)||0))},W=()=>{var s,r;let a=parseFloat(k.value);isNaN(a)&&(a=Math.round(l.value)||0);const t=((s=e.value.options.layout)==null?void 0:s.minValue)||0,n=((r=e.value.options.layout)==null?void 0:r.maxValue)||100;if(a>n&&(a=n),a<t&&(a=t),V(a),e.value.options.dataLakeVariable&&!o.editingMode){const u=Math.round(a);o.setMiniWidgetLastValue(e.value.hash,u),F(e.value.options.dataLakeVariable.name,u)}d.value=!1};return le(()=>{e.value.options.dataLakeVariable&&D&&de(e.value.options.dataLakeVariable.name,D)}),(a,t)=>{var n,s,r,u,g,c,m;return v(),x("div",{id:"dial",class:L(["flex items-center w-auto",((n=i(o).elementToShowOnDrawer)==null?void 0:n.hash)===i(e).hash&&i(o).editingMode?"bg-[#00000010] ":"border-0"]),style:N({justifyContent:(s=i(e).options.layout)==null?void 0:s.align}),onClick:t[2]||(t[2]=f=>i(o).editingMode&&i(o).showElementPropsDrawer(i(e).hash))},[p("div",{class:L(["flex flex-row",i(o).editingMode?"pointer-events-none":"pointer-events-auto"])},[p("div",{class:L(["potentiometer-container w-full",$.value]),onMousedown:q,onClick:t[0]||(t[0]=f=>d.value=!1)},[p("div",ce,[p("div",{class:"potentiometer-knob",style:N({transform:`rotate(${y.value}deg)`,background:((r=i(e).options.layout)==null?void 0:r.knobColor)||"#838383"})},[p("div",{class:"knob-notch",style:N({background:((u=i(e).options.layout)==null?void 0:u.notchColor)||"#222222"})},null,4)],4)])],34),((g=i(e).options.layout)==null?void 0:g.minValue)>=((c=i(e).options.layout)==null?void 0:c.maxValue)?(v(),x("p",ve," Min value is larger than Max value ")):h("",!0)],2),(m=i(e).options.layout)!=null&&m.showValue?(v(),x("div",{key:0,class:"flex",onKeydown:K(W,["esc"])},[p("div",{class:L(["value-display bg-[#FFFFFF22] border-[1px] rounded-md p-[2px] min-w-[40px] text-center elevation-1",d.value?"pointer-events-auto border-blue-800 bg-[#0000FF11]":"cursor-pointer border-[#FFFFFF44] bg-[#FFFFFF22]"])},[d.value?h("",!0):(v(),x("div",{key:0,onClick:Q},ie(Math.round(l.value)||0),1)),d.value?se((v(),x("input",{key:1,"onUpdate:modelValue":t[1]||(t[1]=f=>k.value=f),class:"bg-transparent border-0 text-center outline-none max-w-[30px]",onKeydown:K(W,["enter"]),onBlur:W},null,544)),[[ue,k.value]]):h("",!0)],2),p("div",pe,[d.value?h("",!0):(v(),P(X,{key:0,class:"text-white text-[16px] -mt-[2px] ml-2 cursor-pointer opacity-30",onClick:G},{default:j(()=>t[3]||(t[3]=[U("mdi-plus")])),_:1})),d.value?h("",!0):(v(),P(X,{key:1,class:"text-white text-[16px] -mb-1 ml-2 cursor-pointer opacity-30",onClick:J},{default:j(()=>t[4]||(t[4]=[U("mdi-minus")])),_:1}))])],32)):h("",!0)],6)}}}),be=me(Ve,[["__scopeId","data-v-5bccca0d"]]);export{be as default};
