import{c as Z,e as ee,t as ae,r as N,w as W,h as y,o as te,aN as oe,j as ne,m as M,n as v,p as m,v as p,s as z,y as L,x as B,z as n,aP as O,P as le,B as ie,aH as se,E as P,G as K,aa as U,ac as ue,aK as re,a5 as j,aO as de,_ as ve}from"./index-C8maa8ku.js";import{A as ce}from"./AlertIcon-BBNB53hE.js";const me={class:"potentiometer-scale elevation-5"},pe={key:0,class:"absolute bg-[#880000] pa-2 text-xs mt-2 -ml-12 border-2 border-white rounded-md z-50"},ge={class:"flex flex-col w-4 h-7 justify-between items-center"},b=0,$=100,R=300,be=Z({__name:"Dial",props:{miniWidget:{}},setup(X){const o=ee(),a=ae(X).miniWidget,l=N(b),g=R/2,_=N(-g);let h;const u=N(!1),D=N(String(Math.round(l.value)||b));W(()=>o.miniWidgetManagerVars(a.value.hash).configMenuOpen,e=>{e===!0&&(o.showElementPropsDrawer(a.value.hash),setTimeout(()=>{o.miniWidgetManagerVars(a.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const r=y(()=>{var e;return Number((e=a.value.options.layout)==null?void 0:e.minValue)||b}),V=y(()=>{var e;return Number((e=a.value.options.layout)==null?void 0:e.maxValue)||$}),c=e=>{let t;e==null||isNaN(Number(e))?t=r.value:t=Number(e),l.value=t;const s=V.value-r.value;_.value=(t-r.value)/s*R-g},i=y(()=>{var e;return((e=a.value.options.dataLakeVariable)==null?void 0:e.id)||o.editingMode}),S=y(()=>{var e;return(e=a.value.options.dataLakeVariable)==null?void 0:e.allowUserToChangeValue}),A=()=>{var e,t;a.value.options.dataLakeVariable&&(h=ue((e=a.value.options.dataLakeVariable)==null?void 0:e.id,s=>{c(s)}),c(re((t=a.value.options.dataLakeVariable)==null?void 0:t.id)))};W(()=>{var e;return(e=a.value.options.dataLakeVariable)==null?void 0:e.id},(e,t)=>{t&&h&&j(t,h),e&&A()}),W(()=>[r.value,V.value],([e])=>{l.value=e,c(l.value)}),te(()=>{(!a.value.options||Object.keys(a.value.options).length===0)&&(a.value.isCustomElement=!0,o.updateElementOptions(a.value.hash,{layout:{minValue:b,maxValue:$,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",dataLakeVariable:void 0})),a.value.options.dataLakeVariable?(a.value.options.dataLakeVariable.allowUserToChangeValue||oe({...a.value.options.dataLakeVariable,allowUserToChangeValue:!0}),A()):c(o.getMiniWidgetLastValue(a.value.hash))});const Y=y(()=>{var e;switch((e=a.value.options.layout)==null?void 0:e.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}}),C=()=>{if(i.value&&!o.editingMode){const e=Math.round(l.value);o.setMiniWidgetLastValue(a.value.hash,e),de(a.value.options.dataLakeVariable.id,e)}};let I=0;const G=e=>{if(e.preventDefault(),!i.value)return;const s=e.currentTarget.getBoundingClientRect(),F=s.left+s.width/2,E=s.top+s.height/2,f=w=>{const x=Math.atan2(w.clientX-F,E-w.clientY)*180/Math.PI;if(Math.abs(x-I)>g)return;let d=Math.max(-g,Math.min(g,x));_.value=d,I=d;const Q=V.value-r.value;l.value=(d+g)/R*Q+r.value,a.value.options.dataLakeVariable&&C()},k=()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",k)};document.addEventListener("mousemove",f),document.addEventListener("mouseup",k)},H=()=>{l.value<V.value&&(c(l.value+1),C())},q=()=>{l.value>r.value&&(c(l.value-1),C())},J=()=>{o.editingMode||!i.value||S.value||(u.value=!0,D.value=String(Math.round(l.value)||b))},T=()=>{let e=parseFloat(D.value);isNaN(e)&&(e=Math.round(l.value)||b),e=Math.max(r.value,Math.min(e,V.value)),c(e),C(),u.value=!1};return ne(()=>{a.value.options.dataLakeVariable&&h&&j(a.value.options.dataLakeVariable.id,h)}),(e,t)=>{var s,F,E,f,k,w,x;return v(),M("div",{id:"dial",class:L(["flex items-center relative w-auto",((s=n(o).elementToShowOnDrawer)==null?void 0:s.hash)===n(a).hash&&n(o).editingMode?"bg-[#00000010] ":"border-0"]),style:B({justifyContent:(F=n(a).options.layout)==null?void 0:F.align}),onClick:t[3]||(t[3]=d=>n(o).editingMode&&n(o).showElementPropsDrawer(n(a).hash))},[m("div",{class:L(["flex flex-row",[n(o).editingMode||!i.value||!S.value?"pointer-events-none":"pointer-events-auto",i.value?"":"brightness-50 contrast-50"]])},[m("div",{class:L(["potentiometer-container w-full",Y.value]),onMousedown:G,onClick:t[0]||(t[0]=d=>u.value=!1)},[m("div",me,[m("div",{class:"potentiometer-knob",style:B({transform:`rotate(${_.value}deg)`,background:((E=n(a).options.layout)==null?void 0:E.knobColor)||"#838383"})},[m("div",{class:"knob-notch",style:B({background:((f=n(a).options.layout)==null?void 0:f.notchColor)||"#222222"})},null,4)],4)])],34),((k=n(a).options.layout)==null?void 0:k.minValue)>=((w=n(a).options.layout)==null?void 0:w.maxValue)?(v(),M("p",pe," Min value is larger than Max value ")):p("",!0)],2),(x=n(a).options.layout)!=null&&x.showValue?(v(),M("div",{key:0,class:L(["flex",i.value?"":"brightness-50 contrast-50"]),onKeydown:O(T,["esc"])},[m("div",{class:L(["value-display bg-[#FFFFFF22] border-[1px] rounded-md p-[2px] min-w-[40px] text-center elevation-1",i.value&&u.value?"pointer-events-auto border-blue-800 bg-[#0000FF11]":"cursor-pointer border-[#FFFFFF44] bg-[#FFFFFF22]"])},[!u.value||!i.value?(v(),M("div",{key:0,onClick:J},ie(Math.round(l.value)||0),1)):p("",!0),u.value&&i.value?le((v(),M("input",{key:1,"onUpdate:modelValue":t[1]||(t[1]=d=>D.value=d),class:"bg-transparent border-0 text-center outline-none max-w-[30px]",onKeydown:O(T,["enter"]),onBlur:T},null,544)),[[se,D.value]]):p("",!0)],2),m("div",ge,[!u.value&&i.value?(v(),z(U,{key:0,class:"text-white text-[16px] -mt-[2px] ml-2 cursor-pointer opacity-30",onClick:H},{default:P(()=>t[4]||(t[4]=[K("mdi-plus")])),_:1,__:[4]})):p("",!0),!u.value&&i.value?(v(),z(U,{key:1,class:"text-white text-[16px] -mb-1 ml-2 cursor-pointer opacity-30",onClick:q},{default:P(()=>t[5]||(t[5]=[K("mdi-minus")])),_:1,__:[5]})):p("",!0)])],34)):p("",!0),i.value?p("",!0):(v(),z(ce,{key:1,icon:"mdi-connection",color:"#b9af1d",animation:"pulse",class:"absolute center ml-20 mt-4",tooltip:"This element isn't connected to a data-lake variable yet. Right click and select options to configure it.",onClick:t[2]||(t[2]=d=>n(o).showElementPropsDrawer(n(a).hash))}))],6)}}}),ke=ve(be,[["__scopeId","data-v-0af5bb50"]]);export{ke as default};
