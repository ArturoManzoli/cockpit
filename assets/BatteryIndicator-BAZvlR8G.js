import{c as P,J as F,u as B,y as U,K as k,r as p,k as c,w as D,L as O,M as j,h as A,l as g,m as w,G as z,T as G,v as I,q as a,n as o,t as f,H as r,N as x,V as R,O as q,P as E,Q as H,R as J,S,U as K,W as L,F as Q}from"./index-BPvrKWyM.js";const $={class:"flex flex-col w-[4rem] select-none text-sm font-semibold leading-4 text-end"},X={class:"w-full"},Y={class:"flex justify-end gap-x-1 items-center"},Z={class:"font-mono"},ee={class:"w-full"},te={key:0,class:"flex justify-end gap-x-1 items-center"},se={class:"font-mono mt-[2px]"},oe={key:1,class:"flex justify-end gap-x-1 items-center text-yellow-100"},ae={class:"font-mono mt-[2px]"},le={class:"text-red-500 text-center text-sm w-[full]"},u=500,ie=P({__name:"BatteryIndicator",props:{miniWidget:{}},setup(C){const e=F(C).miniWidget,h={showCurrent:!0,showPower:!0,toggleInterval:1e3},s=B(),V=U(),M=k(),v=p(!0),d=p(void 0),m=p(""),y=p(void 0),l=p(e.value.options.toggleInterval??h.toggleInterval),T=c(()=>{var i;return((i=s==null?void 0:s.powerSupply)==null?void 0:i.voltage)===void 0?NaN:Math.abs(s.powerSupply.voltage)>=100?s.powerSupply.voltage.toFixed(0):s.powerSupply.voltage.toFixed(1)}),W=c(()=>{var i;return((i=s==null?void 0:s.powerSupply)==null?void 0:i.current)===void 0?NaN:Math.abs(s.powerSupply.current)>=100?s.powerSupply.current.toFixed(0):s.powerSupply.current.toFixed(1)}),_=c(()=>s.instantaneousWatts!==void 0?s.instantaneousWatts.toFixed(1):NaN),N=c(()=>"mdi-battery"),b=()=>{(d.value||y.value)&&(clearInterval(d.value),clearTimeout(y.value)),l.value<u?(e.value.options.toggleInterval=u,m.value=`Interval must be at least ${u}ms.`):e.value.options.toggleInterval=l.value,!e.value.options.showCurrent&&!e.value.options.showPower&&(e.value.options.showCurrent=!0,e.value.options.showPower=!0,m.value="At least one of the options must be enabled."),e.value.options.showCurrent&&e.value.options.showPower?d.value=setInterval(()=>{v.value=!v.value},e.value.options.toggleInterval):v.value=e.value.options.showCurrent,y.value=setTimeout(()=>{m.value="",l.value<u&&(l.value=u)},5e3)};return D([()=>e.value.options,l],b,{deep:!0}),O(()=>{e.value.options=Object.assign({},h,e.value.options),b(),j.registerUsage("Instantaneous Watts")}),A(()=>{d.value===void 0&&clearInterval(d.value)}),(i,t)=>(g(),w(Q,null,[z((g(),w("div",{class:I(["flex items-center w-[110px] h-12 text-white justify-center",{"w-[80px]":!a(s).isVehicleOnline}])},[o("span",{class:I(["relative w-[1.5rem] mdi battery-icon mr-4",[N.value]])},t[4]||(t[4]=[o("span",{class:"absolute text-sm text-yellow-400 -bottom-[2px] -right-[7px] mdi mdi-alert-circle"},null,-1)]),2),o("div",$,[o("div",X,[o("div",Y,[o("span",Z,f(T.value||"0"),1),t[5]||(t[5]=o("div",{class:"w-[15px] mr-[1px] -ml-[1px]"},"V",-1))])]),o("div",ee,[v.value?(g(),w("div",te,[o("span",se,f(W.value||"0"),1),t[6]||(t[6]=o("div",{class:"w-[15px]"},"A",-1))])):(g(),w("div",oe,[o("span",ae,f(_.value||"0"),1),t[7]||(t[7]=o("div",{class:"w-[15px]"},"W",-1))]))])])],2)),[[G,"Battery information"]]),r(L,{modelValue:a(V).miniWidgetManagerVars(a(e).hash).configMenuOpen,"onUpdate:modelValue":t[3]||(t[3]=n=>a(V).miniWidgetManagerVars(a(e).hash).configMenuOpen=n),width:"auto"},{default:x(()=>[r(R,{class:"pa-4 text-white w-[20rem]",style:q([{"border-radius":"15px"},a(M).globalGlassMenuStyles])},{default:x(()=>[r(E,{class:"text-center"},{default:x(()=>t[8]||(t[8]=[H("Battery Indicator Config")])),_:1}),r(J,{class:"flex flex-col gap-y-4"},{default:x(()=>[r(S,{modelValue:a(e).options.showCurrent,"onUpdate:modelValue":t[0]||(t[0]=n=>a(e).options.showCurrent=n),label:"Show Current","hide-details":""},null,8,["modelValue"]),r(S,{modelValue:a(e).options.showPower,"onUpdate:modelValue":t[1]||(t[1]=n=>a(e).options.showPower=n),label:"Show Power","hide-details":""},null,8,["modelValue"]),r(K,{modelValue:l.value,"onUpdate:modelValue":t[2]||(t[2]=n=>l.value=n),modelModifiers:{number:!0},label:"Toggle Interval (ms)",type:"number",min:u,step:"100",density:"compact",variant:"outlined",disabled:!a(e).options.showCurrent||!a(e).options.showPower},null,8,["modelValue","disabled"]),o("p",le,f(m.value),1)]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])],64))}});export{ie as default};
