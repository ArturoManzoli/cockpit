import{c as ee,e as ae,t as te,r as _,w as S,h,o as oe,j as ne,s as N,n as v,E as A,p as c,a9 as le,z as o,m as T,v as m,y as W,x as O,aQ as j,P as ie,B as se,aH as ue,aa as $,G as U,a8 as re,ac as de,aK as ve,a5 as X,aP as ce,_ as pe}from"./index-D6uV4iv9.js";import{A as me}from"./AlertIcon-4RZPqScJ.js";const ge={class:"potentiometer-scale elevation-5"},be={key:0,class:"absolute bg-[#880000] pa-2 text-xs mt-2 -ml-12 border-2 border-white rounded-md z-50"},fe={class:"flex flex-col w-4 h-7 justify-between items-center"},V=0,Y=100,I=300,he=ee({__name:"Dial",props:{miniWidget:{}},setup(G){const n=ae(),a=te(G).miniWidget,l=_(V),g=I/2,z=_(-g);let k;const s=_(!1),L=_(String(Math.round(l.value)||V));S(()=>n.miniWidgetManagerVars(a.value.hash).configMenuOpen,e=>{e===!0&&(n.showElementPropsDrawer(a.value.hash),setTimeout(()=>{n.miniWidgetManagerVars(a.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const u=h(()=>{var e;return Number((e=a.value.options.layout)==null?void 0:e.minValue)||V}),x=h(()=>{var e;return Number((e=a.value.options.layout)==null?void 0:e.maxValue)||Y}),p=e=>{let t;e==null||isNaN(Number(e))?t=u.value:t=Number(e),l.value=t;const i=x.value-u.value;z.value=(t-u.value)/i*I-g},r=h(()=>{var e;return!!((e=a.value.options.dataLakeVariable)!=null&&e.id)}),B=h(()=>{var e;return((e=a.value.options.dataLakeVariable)==null?void 0:e.allowUserToChangeValue)===!0}),d=h(()=>{var e;return!!((e=a.value.options.dataLakeVariable)!=null&&e.id)&&B.value&&!n.editingMode}),R=()=>{var e,t;a.value.options.dataLakeVariable&&(k=de((e=a.value.options.dataLakeVariable)==null?void 0:e.id,i=>{p(i)}),p(ve((t=a.value.options.dataLakeVariable)==null?void 0:t.id)))};S(()=>{var e;return(e=a.value.options.dataLakeVariable)==null?void 0:e.id},(e,t)=>{t&&k&&X(t,k),e&&R()}),S(()=>[u.value,x.value],([e])=>{l.value=e,p(l.value)}),oe(()=>{(!a.value.options||Object.keys(a.value.options).length===0)&&(a.value.isCustomElement=!0,n.updateElementOptions(a.value.hash,{layout:{minValue:V,maxValue:Y,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",dataLakeVariable:void 0})),a.value.options.dataLakeVariable?R():p(n.getMiniWidgetLastValue(a.value.hash))});const H=h(()=>{var e;switch((e=a.value.options.layout)==null?void 0:e.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}}),D=()=>{if(B.value&&!n.editingMode){const e=Math.round(l.value);n.setMiniWidgetLastValue(a.value.hash,e),ce(a.value.options.dataLakeVariable.id,e)}};let K=0;const Q=e=>{if(e.preventDefault(),!d.value)return;const i=e.currentTarget.getBoundingClientRect(),C=i.left+i.width/2,E=i.top+i.height/2,y=F=>{const M=Math.atan2(F.clientX-C,E-F.clientY)*180/Math.PI;if(Math.abs(M-K)>g)return;let b=Math.max(-g,Math.min(g,M));z.value=b,K=b;const f=x.value-u.value;l.value=(b+g)/I*f+u.value,a.value.options.dataLakeVariable&&D()},w=()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",w)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",w)},q=()=>{l.value<x.value&&(p(l.value+1),D())},J=()=>{l.value>u.value&&(p(l.value-1),D())},Z=()=>{!d.value||!r.value||(s.value=!0,L.value=String(Math.round(l.value)||V))},P=()=>{let e=parseFloat(L.value);isNaN(e)&&(e=Math.round(l.value)||V),e=Math.max(u.value,Math.min(e,x.value)),p(e),D(),s.value=!1};return ne(()=>{a.value.options.dataLakeVariable&&k&&X(a.value.options.dataLakeVariable.id,k)}),(e,t)=>(v(),N(re,{text:"This element is on display mode. To make it interactive, create or select a different data-lake variable",location:"top","open-delay":"500",disabled:B.value||!r.value},{activator:A(({props:i})=>{var C,E,y,w,F,M,b;return[c("div",le(i,{id:"dial",class:["flex items-center relative w-auto",((C=o(n).elementToShowOnDrawer)==null?void 0:C.hash)===o(a).hash&&o(n).editingMode?"bg-[#00000010] ":"border-0"],style:{justifyContent:(E=o(a).options.layout)==null?void 0:E.align},onClick:t[3]||(t[3]=f=>o(n).editingMode&&o(n).showElementPropsDrawer(o(a).hash))}),[c("div",{class:W(["flex flex-row",[d.value?"pointer-events-auto cursor-pointer":"pointer-events-none cursor-default",r.value?"":"opacity-50"]])},[c("div",{class:W(["potentiometer-container w-full",H.value]),onMousedown:Q,onClick:t[0]||(t[0]=f=>s.value=!1)},[c("div",ge,[c("div",{class:"potentiometer-knob",style:O({transform:`rotate(${z.value}deg)`,background:((y=o(a).options.layout)==null?void 0:y.knobColor)||"#838383"})},[c("div",{class:"knob-notch",style:O({background:((w=o(a).options.layout)==null?void 0:w.notchColor)||"#222222"})},null,4)],4)])],34),((F=o(a).options.layout)==null?void 0:F.minValue)>=((M=o(a).options.layout)==null?void 0:M.maxValue)?(v(),T("p",be," Min value is larger than Max value ")):m("",!0)],2),(b=o(a).options.layout)!=null&&b.showValue?(v(),T("div",{key:0,class:W(["flex",{"opacity-50 pointer-events-none":!r.value,"pointer-events-none cursor-default":!d.value&&r.value}]),onKeydown:j(P,["esc"])},[c("div",{class:W(["value-display bg-[#FFFFFF22] border-[1px] rounded-md p-[2px] min-w-[40px] text-center elevation-1",s.value&&d.value?"pointer-events-auto border-blue-800 bg-[#0000FF11]":d.value?"cursor-pointer border-[#FFFFFF44] bg-[#FFFFFF22]":"pointer-events-none cursor-default border-[#FFFFFF44] bg-[#FFFFFF22]"])},[!s.value||!r.value?(v(),T("div",{key:0,onClick:Z},se(Math.round(l.value)||0),1)):m("",!0),s.value&&r.value?ie((v(),T("input",{key:1,"onUpdate:modelValue":t[1]||(t[1]=f=>L.value=f),class:"bg-transparent border-0 text-center outline-none max-w-[30px]",onKeydown:j(P,["enter"]),onBlur:P},null,544)),[[ue,L.value]]):m("",!0)],2),c("div",fe,[!s.value&&d.value?(v(),N($,{key:0,class:"text-white text-[16px] -mt-[2px] ml-2 cursor-pointer opacity-30",onClick:q},{default:A(()=>t[4]||(t[4]=[U(" mdi-plus ")])),_:1,__:[4]})):m("",!0),!s.value&&d.value?(v(),N($,{key:1,class:"text-white text-[16px] -mb-1 ml-2 cursor-pointer opacity-30",onClick:J},{default:A(()=>t[5]||(t[5]=[U(" mdi-minus ")])),_:1,__:[5]})):m("",!0)])],34)):m("",!0),!r.value&&!o(n).editingMode?(v(),N(me,{key:1,icon:"mdi-connection",color:"#b9af1d",animation:"pulse",class:"absolute center ml-20 mt-[10px]",tooltip:"This element isn't connected to a data-lake variable yet. Click here to configure it.",onClick:t[2]||(t[2]=f=>o(n).showElementPropsDrawer(o(a).hash))})):m("",!0)],16)]}),_:1},8,["disabled"]))}}),ye=pe(he,[["__scopeId","data-v-8730874a"]]);export{ye as default};
