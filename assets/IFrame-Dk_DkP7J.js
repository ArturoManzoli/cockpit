import{c as j,bD as A,k as M,K as H,y as P,r,J as G,aS as K,L as J,bL as D,al as Q,w as E,l as g,m,n as i,H as o,v as s,N as w,x as q,G as b,O as n,Q as V,a6 as X,t as Y,a7 as C,a$ as L,I as Z,as as ee,V as ae,P as te,R as se,U as N,aP as oe,T as le,aR as ie,bM as ne,s as de,ad as ue,am as re,bH as ce,W as ve,bN as pe,F as fe,bO as me,a9 as he,_ as ge}from"./index-Bpd_ESZM.js";const we={class:"w-full h-full"},be=["width","height"],Ve={class:"flex flex-col justify-start items-center h-auto pt-2 cursor-pointer"},xe={class:"flex justify-between w-full h-[25px] px-2"},ye={class:"select-none"},_e={class:"pt-2"},ke=["src"],Se={key:1},Me=["src"],Ce={class:"flex items-center justify-between"},Le={class:"mt-2 mb-2 w-[95%]"},Fe={class:"flex justify-between"},Ue={key:0},ze=j({__name:"IFrame",props:{widget:{}},setup(T){A(t=>({"18b7f5cb":$.value}));const F=H(),d=P(),x=r(),e=G(T).widget,y=r(!1),_=r(0),u=r(e.value.options.source),h=r(!1),k=r(""),p=r(!1),B=()=>{p.value=!p.value},I=()=>{d.allowMovingAndResizing(e.value.hash,!0),window.addEventListener("mouseup",f),window.addEventListener("dragend",f)},f=()=>{d.allowMovingAndResizing(e.value.hash,!1),window.removeEventListener("mouseup",f),window.removeEventListener("dragend",f)},c=M(()=>({width:e.value.size.width*v.value,height:e.value.size.height*v.value})),S=t=>me(t)?!0:"URL is not valid.",U=()=>{const t=S(u.value);if(t!==!0){k.value=`${t} Please enter a valid URL.`,h.value=!0;return}e.value.options.source=u.value,k.value=`IFrame URL sucessfully updated to '${u.value}'.`,h.value=!0},z=t=>{if(t.data.type!=="cockpit:listenToDatalakeVariables")return;const{variable:a}=t.data;he(a,l=>{x.value.contentWindow.postMessage({type:"cockpit:datalakeVariable",variable:a,value:l},"*")})};J(()=>{window.addEventListener("message",z,!0),Object.keys(e.value.options).length===0&&(e.value.options={source:"http://"+D},u.value=D)}),Q(()=>{window.removeEventListener("message",z,!0)});const{width:v,height:R}=K(),O=M(()=>{let t="";return t=t.concat(" ",`left: ${e.value.position.x*v.value}px;`),t=t.concat(" ",`top: ${e.value.position.y*R.value}px;`),t=t.concat(" ",`width: ${e.value.size.width*v.value}px;`),t=t.concat(" ",`height: ${e.value.size.height*R.value}px;`),d.editingMode&&(t=t.concat(" ","pointer-events:none; border:0;")),d.isWidgetVisible(e.value)||(t=t.concat(" ","display: none;")),t}),$=M(()=>(100-_.value)/100);function W(){console.log("Finished loading"),y.value=!0}return E(e.value.options.isFixedSize,t=>{t||(e.value.size={width:c.value.width/v.value,height:c.value.height/v.value}),t&&(!e.value.options.fixedWidth||!e.value.options.fixedHeight)&&(e.value.options.fixedWidth=c.value.width,e.value.options.fixedHeight=c.value.height)}),E(e,()=>{d.widgetManagerVars(e.value.hash).configMenuOpen===!1&&S(u.value)!==!0&&(u.value=e.value.options.source)},{deep:!0}),(t,a)=>(m(),g(fe,null,[i("div",we,[s(e).options.isCollapsible?(m(),g("div",{key:0,ref:"iframe-container",class:q(["w-full rounded-lg overflow-hidden -mt-2",[p.value?"h-[42px]":"h-full"]]),width:c.value.width,height:c.value.height,style:w(s(F).globalGlassMenuStyles)},[i("div",Ve,[i("div",xe,[o(X,{class:"cursor-grab opacity-40",onMousedown:I,onMouseup:f},{default:n(()=>a[7]||(a[7]=[V(" mdi-drag ")])),_:1,__:[7]}),i("div",ye,Y(s(e).options.containerName||"iframe"),1),o(C,{icon:p.value?"mdi-chevron-down":"mdi-chevron-up",variant:"text",size:"36",class:"mt-[-6px] opacity-60",onClick:B},null,8,["icon"])]),b(i("div",_e,[b(i("iframe",{ref_key:"iframe",ref:x,src:s(e).options.source,style:w(O.value),frameborder:"0",onLoad:W},null,44,ke),[[L,y.value]])],512),[[L,!p.value]])])],14,be)):(m(),g("div",Se,[(m(),Z(ee,{to:".widgets-view"},[b(i("iframe",{ref_key:"iframe",ref:x,src:s(e).options.source,style:w([O.value,{position:"absolute"}]),frameborder:"0",onLoad:W},null,44,Me),[[L,y.value]])]))])),o(ve,{modelValue:s(d).widgetManagerVars(s(e).hash).configMenuOpen,"onUpdate:modelValue":a[5]||(a[5]=l=>s(d).widgetManagerVars(s(e).hash).configMenuOpen=l),"min-width":"400","max-width":"35%"},{default:n(()=>[o(ae,{class:"pa-2",style:w(s(F).globalGlassMenuStyles)},{default:n(()=>[o(te,{class:"text-center"},{default:n(()=>a[8]||(a[8]=[V("Settings")])),_:1,__:[8]}),o(se,null,{default:n(()=>[i("div",null,[a[9]||(a[9]=i("p",null,"Iframe Source",-1)),i("div",Ce,[o(N,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=l=>u.value=l),variant:"filled",outlined:"",rules:[S],onKeydown:oe(U,["enter"])},null,8,["modelValue","rules"]),b(o(C,{icon:"mdi-check",class:"mx-1 mb-5 bg-[#FFFFFF22]",rounded:"lg",flat:"",onClick:U},null,512),[[le,"Set",void 0,{bottom:!0}]])])]),i("div",Le,[o(ie,{modelValue:_.value,"onUpdate:modelValue":a[1]||(a[1]=l=>_.value=l),label:"Transparency",color:"white",min:0,max:90},null,8,["modelValue"])]),o(ne,{compact:"","is-expanded":!0,"no-bottom-divider":"","no-top-divider":""},{title:n(()=>a[10]||(a[10]=[V("Advanced options")])),content:n(()=>[i("div",Fe,[o(ue,{modelValue:s(e).options.isCollapsible,"onUpdate:modelValue":a[2]||(a[2]=l=>s(e).options.isCollapsible=l),label:"Collapsible container",color:"white",class:"ml-2"},null,8,["modelValue"]),s(e).options.isCollapsible?(m(),g("div",Ue,[o(N,{modelValue:s(e).options.containerName,"onUpdate:modelValue":a[3]||(a[3]=l=>s(e).options.containerName=l),label:"Container name","item-title":"name",density:"compact",variant:"outlined","no-data-text":"iframe","hide-details":"",theme:"dark",class:"w-[300px] mt-2"},null,8,["modelValue"])])):de("",!0)])]),_:1})]),_:1}),o(re,{width:"80%",inset:""}),o(ce,{class:"flex justify-end mt-2"},{default:n(()=>[o(C,{color:"white",onClick:a[4]||(a[4]=l=>s(d).widgetManagerVars(s(e).hash).configMenuOpen=!1)},{default:n(()=>a[11]||(a[11]=[V(" Close ")])),_:1,__:[11]})]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])]),o(pe,{"open-snackbar":h.value,message:k.value,duration:3e3,"close-button":!1,"onUpdate:openSnackbar":a[6]||(a[6]=l=>h.value=l)},null,8,["open-snackbar","message"])],64))}}),We=ge(ze,[["__scopeId","data-v-688b8376"]]);export{We as default};
