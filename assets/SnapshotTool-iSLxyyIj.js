import{c as U,a8 as A,K as D,y as j,a9 as P,J as q,ap as G,r as d,w as H,aq as S,L as J,l as M,m as K,n,H as a,N as l,a0 as h,af as r,ar as Q,O as I,q as o,as as c,ag as g,v as z,Q as W,at as R,I as X,s as Y,a1 as Z,ai as O,au as _,t as ee,U as te,a6 as ae,W as se,F as oe}from"./index-DA_DYss9.js";const le={class:"absolute top-0 right-0"},ie={class:"flex w-full justify-end items-center mt-4"},de=U({__name:"SnapshotTool",props:{miniWidget:{}},setup(E){const{showDialog:V}=A(),v=D(),b=j(),w=P(),i=q(E).miniWidget,f=G(),L=d(),y=d("mdi-video"),x=d("video"),m=d(!1),p=d(5),C=d("Selected streams"),u=d(!1),F=async()=>{const t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="black",t.style.opacity="0",t.style.transition="opacity 0.1s ease",t.style.zIndex="9999",document.body.appendChild(t),t.offsetWidth,t.style.opacity="0.4",await new Promise(e=>setTimeout(e,50)),t.style.opacity="0",await new Promise(e=>setTimeout(e,100)),document.body.removeChild(t)},T=async()=>{if($()){m.value=!1;try{x.value!=="timed"&&(F(),S({message:"Snapshot recorded successfully.",variant:"success",duration:2e3}))}catch(t){V({message:`Error taking snapshot: ${t}`,variant:"error"});return}}},N=()=>{m.value=!1,v.videoLibraryVisibility=!0,v.videoLibraryMode="snapshot"},k=t=>{switch(x.value=t,m.value=!1,t){case"video":y.value="mdi-video";break;case"workspace":y.value="mdi-monitor";break;case"timed":y.value="mdi-timer-outline";break}};H(u,t=>{let e;t&&(F(),S({message:`Timed snapshot started. This will capture the selected interfaces every ${p.value} seconds until you press the camera button again.`,variant:"info",duration:4e3}),e=setInterval(()=>{T()},p.value*1e3)),t||(S({message:"Timed snapshot stopped.",variant:"info",duration:2e3}),clearInterval(e))});const $=()=>i.value.options.selectedStreams.every(t=>w.namesAvailableStreams.includes(t))?(i.value.options.nameSelectedStreams=i.value.options.selectedStreams,!0):(V({message:"Selected streams are not available anymore. Please check the currently available options.",variant:"warning"}),!1);return J(async()=>{Object.keys(i.value.options).length===0&&(i.value.options={selectedStreams:void 0})}),(t,e)=>(M(),K(oe,null,[n("div",{ref_key:"recorderWidget",ref:L,class:"flex justify-around pl-1 pr-[3px] py-1 text-center text-white rounded-lg w-[70px] h-9 align-center bg-slate-800/60"},[a(R,{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=s=>m.value=s),offset:"4",transition:"fade-transition"},{activator:l(({props:s})=>[n("div",h(s,{class:"flex flex-col items-center justify-around pl-1 pr-2"}),[a(r,{icon:"mdi-menu-up",class:"text-[22px] -mr-3 -ml-2 -mb-1 opacity-80 cursor-pointer",size:"22"}),a(r,{icon:y.value,class:"text-[22px] -mr-3 -ml-2 mb-1 cursor-pointer opacity-60",size:"14"},null,8,["icon"])],16)]),default:l(()=>[a(Q,{density:"compact",class:"pa-0 text-white rounded-md",style:I(o(v).globalGlassMenuStyles)},{default:l(()=>[a(c,{title:"Video feed",onClick:e[0]||(e[0]=s=>k("video"))},{append:l(()=>[a(r,{size:"22",icon:"mdi-video"})]),_:1}),a(g),a(c,{disabled:!o(f),class:z({"opacity-50 pointer-events-none":!o(f)}),onClick:e[1]||(e[1]=s=>o(f)&&k("workspace"))},{append:l(()=>[a(r,{size:"19",icon:"mdi-monitor"})]),default:l(()=>[e[11]||(e[11]=W(" Cockpit work area "))]),_:1},8,["disabled","class"]),a(g),a(c,{title:"Timed snapshot",onClick:e[2]||(e[2]=s=>k("timed"))},{append:l(()=>[a(r,{size:"20",icon:"mdi-timer-outline"})]),_:1}),a(g),a(c,{class:"bg-[#FFFFFF11] hover:bg-[#FFFFFF22] cursor-pointer text-sm",onClick:N},{title:l(()=>e[12]||(e[12]=[n("span",{class:"text-white text-[16px] font-bold"},"Open snapshot library",-1)])),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"]),a(g,{vertical:""}),a(r,{icon:"mdi-camera",class:"mb-[-2px]",size:"32",onClick:T}),x.value==="timed"?(M(),X(r,{key:0,icon:u.value?"mdi-stop":"mdi-play",class:z(["mb-[-2px] cursor-pointer mr-1 bg-[#FFFFFFff] rounded-full",{"text-red-500 -ml-[32px]":u.value,"text-green-500 -ml-[33px]":!u.value}]),size:"22",onClick:e[4]||(e[4]=s=>u.value=!u.value)},null,8,["icon","class"])):Y("",!0)],512),a(se,{modelValue:o(b).miniWidgetManagerVars(o(i).hash).configMenuOpen,"onUpdate:modelValue":e[10]||(e[10]=s=>o(b).miniWidgetManagerVars(o(i).hash).configMenuOpen=s),width:"auto"},{default:l(()=>[n("div",{class:"flex flex-col items-center p-2 px-4 pt-1 m-5 rounded-md gap-y-4",style:I(o(v).globalGlassMenuStyles)},[e[15]||(e[15]=n("p",{class:"text-xl font-semibold mt-2 mb-4"},"Snapshot settings",-1)),n("div",le,[a(Z,{location:"bottom","open-on-click":"",persistent:!1,"open-on-hover":!1,"open-on-focus":!1,"close-on-content-click":""},{activator:l(({props:s})=>[a(r,h(s,{icon:"mdi-information-outline",class:"absolute top-2 right-2 cursor-pointer text-white",size:"18"}),null,16)]),default:l(()=>[e[13]||(e[13]=n("span",null," Some features like “Capturing Cockpit work area” are only available in the Electron version. ",-1))]),_:1})]),a(O,{modelValue:o(i).options.selectedStreams,"onUpdate:modelValue":e[5]||(e[5]=s=>o(i).options.selectedStreams=s),items:o(w).namesAvailableStreams||[],density:"compact",multiple:"",clearable:"",label:"Streams to capture",variant:"outlined","no-data-text":"No streams available.","hide-details":"",theme:"dark",class:"w-[90%]"},null,8,["modelValue","items"]),a(O,{"model-value":C.value,label:"Timed snapshot target",items:[{value:"Selected streams",text:"Selected streams"},{value:"Cockpit work area",text:"Cockpit work area"}],"item-title":"text","item-value":"value",density:"compact",variant:"outlined","no-data-text":"No options available.","hide-details":"",theme:"dark",class:"w-[90%] mt-2","onUpdate:modelValue":e[6]||(e[6]=s=>C.value=s)},{item:l(({item:s,props:B})=>[a(c,h(B,{disabled:s.value==="Cockpit work area"&&!o(f)}),{default:l(()=>[a(_,{textContent:ee(s.text)},null,8,["textContent"])]),_:2},1040,["disabled"])]),_:1},8,["model-value"]),a(te,{modelValue:p.value,"onUpdate:modelValue":[e[7]||(e[7]=s=>p.value=s),e[8]||(e[8]=s=>p.value=parseInt(s))],modelModifiers:{number:!0},label:"Timed snapshot interval (seconds)",type:"number",density:"compact",variant:"outlined","hide-details":"",theme:"dark",class:"w-[90%] mt-2",min:1,step:"1"},null,8,["modelValue"]),n("div",ie,[a(ae,{class:"w-auto text-uppercase",variant:"text",onClick:e[9]||(e[9]=s=>o(b).miniWidgetManagerVars(o(i).hash).configMenuOpen=!1)},{default:l(()=>e[14]||(e[14]=[W(" Close ")])),_:1})])],4)]),_:1},8,["modelValue"])],64))}});export{de as default};
