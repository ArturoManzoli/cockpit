import{c as S,y as A,J as B,r as _,w as C,o as I,k as P,h as T,l as F,m as E,n as c,v as f,O as V,q as n,t as X,s as Y,ax as j,ay as $,aw as q,_ as J}from"./index-DdeKmKAf.js";const U={class:"potentiometer-scale elevation-5"},G={key:0,class:"value-display bg-[#FFFFFF22] border-[#FFFFFF44] border-[1px] rounded-md p-[2px] min-w-9 text-center elevation-1"},H=S({__name:"Dial",props:{miniWidget:{}},setup(W){const t=A(),e=B(W).miniWidget,p=_(0),v=_(-150);let h;C(()=>t.miniWidgetManagerVars(e.value.hash).configMenuOpen,a=>{a===!0&&(t.showElementPropsDrawer(e.value.hash),setTimeout(()=>{t.miniWidgetManagerVars(e.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const b=a=>{var i,l,u,d;let s;a==null||isNaN(Number(a))?s=((i=e.value.options.layout)==null?void 0:i.minValue)||0:s=Number(a),p.value=s;const o=300,r=((l=e.value.options.layout)==null?void 0:l.maxValue)-((u=e.value.options.layout)==null?void 0:u.minValue)||1;v.value=(s-((d=e.value.options.layout)==null?void 0:d.minValue))/r*o-150},y=()=>{var a;if(e.value.options.dataLakeVariable){h=j((a=e.value.options.dataLakeVariable)==null?void 0:a.name,o=>{b(o)});const s=t.getMiniWidgetLastValue(e.value.hash);b(s)}};C(()=>{var a;return(a=e.value.options.dataLakeVariable)==null?void 0:a.name},a=>{a&&y()},{immediate:!0}),I(()=>{(!e.value.options||Object.keys(e.value.options).length===0)&&(e.value.isCustomElement=!0,t.updateElementOptions(e.value.hash,{layout:{minValue:0,maxValue:100,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",dataLakeVariable:void 0})),y()});const R=P(()=>{var a;switch((a=e.value.options.layout)==null?void 0:a.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}}),N=a=>{a.preventDefault();const o=a.currentTarget.getBoundingClientRect(),r=o.left+o.width/2,i=o.top+o.height/2;let l=Math.atan2(a.clientY-i,a.clientX-r)*(180/Math.PI);const u=k=>{var w,L,D;const M=Math.atan2(k.clientY-i,k.clientX-r)*(180/Math.PI);let m=M-l;m>180?m-=360:m<-180&&(m+=360);let g=v.value+m;g=Math.max(-150,Math.min(150,g)),v.value=g,l=M;const O=300,z=(((w=e.value.options.layout)==null?void 0:w.maxValue)||100)-(((L=e.value.options.layout)==null?void 0:L.minValue)||0);if(p.value=(g+150)/O*z+(((D=e.value.options.layout)==null?void 0:D.minValue)||0),e.value.options.dataLakeVariable){if(t.editingMode)return;const x=Math.round(p.value);t.setMiniWidgetLastValue(e.value.hash,x),q(e.value.options.dataLakeVariable.name,x)}},d=()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",d)};document.addEventListener("mousemove",u),document.addEventListener("mouseup",d)};return T(()=>{e.value.options.dataLakeVariable&&h&&$(e.value.options.dataLakeVariable.name,h)}),(a,s)=>{var o,r,i,l,u;return F(),E("div",{id:"dial",class:f(["flex items-center w-auto",((o=n(t).elementToShowOnDrawer)==null?void 0:o.hash)===n(e).hash&&n(t).editingMode?"bg-[#00000010] ":"border-0"]),style:V({justifyContent:(r=n(e).options.layout)==null?void 0:r.align}),onClick:s[0]||(s[0]=d=>n(t).editingMode&&n(t).showElementPropsDrawer(n(e).hash))},[c("div",{class:f(["flex flex-row",n(t).editingMode?"pointer-events-none":"pointer-events-auto"])},[c("div",{class:f(["potentiometer-container w-full",R.value]),onMousedown:N},[c("div",U,[c("div",{class:"potentiometer-knob",style:V({transform:`rotate(${v.value}deg)`,background:((i=n(e).options.layout)==null?void 0:i.knobColor)||"#838383"})},[c("div",{class:"knob-notch",style:V({background:((l=n(e).options.layout)==null?void 0:l.notchColor)||"#222222"})},null,4)],4)])],34)],2),(u=n(e).options.layout)!=null&&u.showValue?(F(),E("div",G,X(Math.round(p.value)||0),1)):Y("",!0)],6)}}}),Z=J(H,[["__scopeId","data-v-bbc6dbef"]]);export{Z as default};
