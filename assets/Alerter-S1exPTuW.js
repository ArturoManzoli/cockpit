import{d as q,u as G,a as N,w as v,A as g,b as n,c as P,t as J,e as K,f as Q,r as b,h as y,o as X,i as Y,j as Z,k as ee,l as L,m as h,n as w,p as r,q as m,s as te,v as x,x as l,y as p,z as le,F as U,B as se,C as re,V as j,D as S,E as oe,G as H,H as ne,I as ae,_ as ie}from"./index-zlL9SvBN.js";const de=q("vehicle-alerter",()=>{const i=G(),f=N();v(i.statusText,()=>{i.statusText.text&&f.pushAlert(new g(i.statusText.severity,i.statusText.text))}),v(()=>i.mode,()=>f.pushAlert(new g(n.Info,`Vehicle mode changed to ${i.mode}.`))),v(()=>i.isArmed,o=>{const s=o?"armed":"disarmed";f.pushAlert(new g(n.Info,`Vehicle ${s}`))}),v(()=>i.isVehicleOnline,o=>{const s=o?n.Success:n.Error,c=o?"connected":"disconnected";f.pushAlert(new g(s,`Vehicle ${c}`))})}),ce={class:"mx-1 overflow-hidden text-xl font-medium text-gray-100 text-ellipsis"},ue={class:"flex flex-col justify-center mx-1 font-mono text-xs font-semibold leading-3 text-right text-gray-100"},me=["title"],pe={class:"mx-1 overflow-hidden text-lg font-medium leading-none text-ellipsis"},ve={class:"flex flex-col justify-center mx-1 font-mono text-xs font-semibold leading-3 text-right text-gray-100"},fe={key:0,class:"h-px mx-1 mb-2 bg-slate-50/30"},xe={class:"flex items-start justify-between flex-col -mt-8 mb-6 pl-6"},ge=10,be=P({__name:"Alerter",props:{miniWidget:{}},setup(i){var D;const o=J(i).miniWidget;(D=o.value.options).enableColorCoding??(D.enableColorCoding=!1),de();const s=N(),c=K(),O=Q({interval:1e3}),_=a=>le(a,"HH:mm:ss"),d=b(s.alerts[0]),u=b(!1),$=y(()=>{switch(d.value.level){case n.Critical:return"border: 2px solid transparent";case n.Error:return"border: 2px solid #dc2626;";case n.Warning:return"border: 2px solid #db9340;";case n.Info:return"border: 2px solid #3b82f655;";case n.Success:return"border: 2px solid #308013;";default:return"border: none;"}}),k=y(()=>o.value.options.enableColorCoding&&d.value.level===n.Critical);let B;X(()=>{B=setInterval(()=>{var e;const a=new Date(O.value);if(Y(a,((e=s.alerts.last())==null?void 0:e.time_created)||a)>ge){d.value=new g(n.Info,"No recent alerts.");return}d.value=s.alerts.last()},1e3)}),Z(()=>{clearInterval(B)});const[E,I]=ee(),M=()=>I(!0),A=()=>I(!1),T=b(),V=L(T),W=b(),C=L(W);v(V,(a,t)=>{u.value||(t&&!a&&setTimeout(()=>{!u.value&&!C.value&&!V.value&&A()},250),!E.value&&M())}),v(C,(a,t)=>{u.value||t&&!a&&A()});const z=()=>{const a=!u.value;if(u.value=a,a){M();return}!C.value&&!V.value&&A()},F=y(()=>[...s.sortedAlerts].reverse());return(a,t)=>(w(),h(U,null,[r("div",{class:x(["flex",{"pointer-events-none":l(c).editingMode}])},[r("div",{class:x(["mx-1 my-1.5 w-[500px] rounded-md",{"alert-border-blink":k.value}]),style:te(l(o).options.enableColorCoding?$.value:"border: none;")},[r("div",{ref_key:"currentAlertBar",ref:T,class:x(["flex items-center justify-between p-1 overflow-hidden rounded cursor-pointer select-none whitespace-nowrap",k.value?"bg-[#db151233]":"bg-slate-800/75"])},[r("p",ce,p(d.value.message),1),r("div",ue,[r("p",null,p(_(d.value.time_created||new Date)),1),r("p",null,p(d.value.level.toUpperCase()),1)])],2),r("div",{ref_key:"expandedAlertsBar",ref:W,class:x(["expanded-alerts-bar absolute w-full p-2 transition-all rounded top-12 max-h-[30vh] overflow-y-auto text-slate-50 scrollbar-hide bg-slate-800/75 select-none flex flex-col",{"opacity-0 invisible":!l(E)}])},[(w(!0),h(U,null,se(F.value,(e,R)=>(w(),h("div",{key:e.time_created.toISOString()},[r("div",{title:e.message,class:x(["flex items-center justify-between whitespace-nowrap",{"border-[1px] border-[#dc262699] bg-[#dc262622] pa-1":e.level===l(n).Critical||e.level===l(n).Error}])},[r("p",pe,p(e.message),1),r("div",ve,[r("p",null,p(_(e.time_created||new Date)),1),r("p",null,p(e.level.toUpperCase()),1)])],10,me),R!==l(s).alerts.length-1?(w(),h("div",fe)):re("",!0)]))),128))],2)],6),m(j,{icon:"mdi-arrow-vertical-lock",variant:"text",color:u.value?"orange ":"white",class:"-mr-6 -ml-4 mt-[2px] bg-transparent",onClick:t[0]||(t[0]=e=>z())},null,8,["color"])],2),m(ae,{modelValue:l(c).miniWidgetManagerVars(l(o).hash).configMenuOpen,"onUpdate:modelValue":t[5]||(t[5]=e=>l(c).miniWidgetManagerVars(l(o).hash).configMenuOpen=e),title:"Alerter options","max-width":"400px",variant:"text-only"},{content:S(()=>[r("div",xe,[m(H,{modelValue:l(o).options.enableColorCoding,"onUpdate:modelValue":t[1]||(t[1]=e=>l(o).options.enableColorCoding=e),"hide-details":"",label:"Enable color coded alerts",color:"white"},null,8,["modelValue"]),m(H,{modelValue:l(s).enableVoiceAlerts,"onUpdate:modelValue":t[2]||(t[2]=e=>l(s).enableVoiceAlerts=e),"hide-details":"",label:"Enable voice alerts",color:"white"},null,8,["modelValue"]),m(ne,{modelValue:l(s).alertVolume,"onUpdate:modelValue":t[3]||(t[3]=e=>l(s).alertVolume=e),min:"0",max:"1",step:"0.05","hide-details":"","thumb-label":"",label:"Alert volume",color:"white",class:"w-[250px] mt-2",disabled:!l(s).enableVoiceAlerts},null,8,["modelValue","disabled"])])]),actions:S(()=>[m(j,{onClick:t[4]||(t[4]=e=>l(c).miniWidgetManagerVars(l(o).hash).configMenuOpen=!1)},{default:S(()=>t[6]||(t[6]=[oe("Close")])),_:1,__:[6]})]),_:1},8,["modelValue"])],64))}}),we=ie(be,[["__scopeId","data-v-b7ac3c78"]]);export{we as default};
