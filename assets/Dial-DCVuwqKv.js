import{c as B,z as L,J as P,r as C,w as T,o as I,au as X,k as Y,h as j,av as N,aw as $,l as F,m as D,n as d,x as g,O as h,s as a,t as J,v as U,ax as q,_ as G}from"./index-B5GXSSUo.js";const H={class:"potentiometer-scale elevation-5"},K={key:0,class:"value-display bg-[#FFFFFF22] border-[#FFFFFF44] border-[1px] rounded-md p-[2px] min-w-9 text-center elevation-1"},Q=B({__name:"Dial",props:{miniWidget:{}},setup(_){const o=L(),e=P(_).miniWidget,u=C(0),m=C(-150);T(()=>o.miniWidgetManagerVars(e.value.hash).configMenuOpen,t=>{t===!0&&(o.showElementPropsDrawer(e.value.hash),setTimeout(()=>{o.miniWidgetManagerVars(e.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const f=t=>{var i,s,r;u.value=t;const l=300,n=((i=e.value.options.layout)==null?void 0:i.maxValue)-((s=e.value.options.layout)==null?void 0:s.minValue)||1;m.value=(t-((r=e.value.options.layout)==null?void 0:r.minValue))/n*l-150};I(()=>{var t;(!e.value.options||Object.keys(e.value.options).length===0)&&(e.value.isCustomElement=!0,o.updateElementOptions(e.value.hash,{variableType:"number",actionVariable:void 0,lastValue:void 0,layout:{minValue:0,maxValue:100,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"}})),e.value.options.actionVariable&&(X((t=e.value.options.actionVariable)==null?void 0:t.name,l=>{f(l)}),f(e.value.options.lastValue))});const A=Y(()=>{var t;switch((t=e.value.options.layout)==null?void 0:t.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}}),E=t=>{t.preventDefault();const n=t.currentTarget.getBoundingClientRect(),i=n.left+n.width/2,s=n.top+n.height/2,r=t.clientX-i,p=t.clientY-s,V=Math.atan2(p,r)*(180/Math.PI),R=m.value,b=M=>{var w,x,k;const S=M.clientX-i,z=M.clientY-s;let c=Math.atan2(z,S)*(180/Math.PI)-V;c>180?c-=360:c<-180&&(c+=360);let v=R+c;v=Math.max(-150,Math.min(150,v)),m.value=v;const O=300,W=((w=e.value.options.layout)==null?void 0:w.maxValue)-((x=e.value.options.layout)==null?void 0:x.minValue)||1;if(u.value=(v+150)/O*W+((k=e.value.options.layout)==null?void 0:k.minValue),e.value.options.actionVariable){if(o.editingMode)return;e.value.options.lastValue=u.value.toFixed(1),q(e.value.options.actionVariable.name,u.value.toFixed(1))}},y=()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",y)};document.addEventListener("mousemove",b),document.addEventListener("mouseup",y)};return j(()=>{e.value.options.actionVariable&&(N(e.value.options.actionVariable.name),$(e.value.options.actionVariable.name))}),(t,l)=>{var n,i,s,r,p;return F(),D("div",{id:"dial",class:g(["flex items-center w-auto",((n=a(o).elementToShowOnDrawer)==null?void 0:n.hash)===a(e).hash&&a(o).editingMode?"bg-[#00000010] ":"border-0"]),style:h({justifyContent:(i=a(e).options.layout)==null?void 0:i.align}),onClick:l[0]||(l[0]=V=>a(o).editingMode&&a(o).showElementPropsDrawer(a(e).hash))},[d("div",{class:g(["flex flex-row",a(o).editingMode?"pointer-events-none":"pointer-events-auto"])},[d("div",{class:g(["potentiometer-container w-full",A.value]),onMousedown:E},[d("div",H,[d("div",{class:"potentiometer-knob",style:h({transform:`rotate(${m.value}deg)`,background:((s=a(e).options.layout)==null?void 0:s.knobColor)||"#838383"})},[d("div",{class:"knob-notch",style:h({background:((r=a(e).options.layout)==null?void 0:r.notchColor)||"#222222"})},null,4)],4)])],34)],2),(p=a(e).options.layout)!=null&&p.showValue?(F(),D("div",K,J(Math.round(u.value)||0),1)):U("",!0)],6)}}}),ae=G(Q,[["__scopeId","data-v-1d8ebf00"]]);export{ae as default};
