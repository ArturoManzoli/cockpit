import{d as q,u as G,a as N,w as v,A as x,b as n,c as P,t as J,e as K,f as Q,r as g,h as y,o as X,i as Y,j as Z,k as ee,l as L,m as b,n as h,p as o,q as m,s as te,v as w,x as l,y as p,z as le,F as U,B as se,C as oe,V as j,D as S,E as re,G as H,H as ae,I as ne,_ as ie}from"./index-Bu4bPsLI.js";const de=q("vehicle-alerter",()=>{const i=G(),f=N();v(i.statusText,()=>{i.statusText.text&&f.pushAlert(new x(i.statusText.severity,i.statusText.text))}),v(()=>i.mode,()=>f.pushAlert(new x(n.Info,`Vehicle mode changed to ${i.mode}.`))),v(()=>i.isArmed,r=>{const s=r?"armed":"disarmed";f.pushAlert(new x(n.Info,`Vehicle ${s}`))}),v(()=>i.isVehicleOnline,r=>{const s=r?n.Success:n.Error,c=r?"connected":"disconnected";f.pushAlert(new x(s,`Vehicle ${c}`))})}),ce={class:"mx-1 overflow-hidden text-xl font-medium text-gray-100 text-ellipsis"},ue={class:"flex flex-col justify-center mx-1 font-mono text-xs font-semibold leading-3 text-right text-gray-100"},me=["title"],pe={class:"mx-1 overflow-hidden text-lg font-medium leading-none text-ellipsis"},ve={class:"flex flex-col justify-center mx-1 font-mono text-xs font-semibold leading-3 text-right text-gray-100"},fe={key:0,class:"h-px mx-1 mb-2 bg-slate-50/30"},xe={class:"flex items-start justify-between flex-col -mt-8 mb-6 pl-6"},ge=10,be=P({__name:"Alerter",props:{miniWidget:{}},setup(i){var D;const r=J(i).miniWidget;(D=r.value.options).enableColorCoding??(D.enableColorCoding=!1),de();const s=N(),c=K(),O=Q({interval:1e3}),_=a=>le(a,"HH:mm:ss"),d=g(s.alerts[0]),u=g(!1),$=y(()=>{switch(d.value.level){case n.Critical:return"border: 2px solid transparent";case n.Error:return"border: 2px solid #dc2626;";case n.Warning:return"border: 2px solid #db9340;";case n.Info:return"border: 2px solid #3b82f655;";case n.Success:return"border: 2px solid #308013;";default:return"border: none;"}}),k=y(()=>r.value.options.enableColorCoding&&d.value.level===n.Critical);let B;X(()=>{B=setInterval(()=>{var t;const a=new Date(O.value);if(Y(a,((t=s.alerts.last())==null?void 0:t.time_created)||a)>ge){d.value=new x(n.Info,"No recent alerts.");return}d.value=s.alerts.last()},1e3)}),Z(()=>{clearInterval(B)});const[E,I]=ee(),M=()=>I(!0),A=()=>I(!1),T=g(),V=L(T),W=g(),C=L(W);v(V,(a,e)=>{u.value||(e&&!a&&setTimeout(()=>{!u.value&&!C.value&&!V.value&&A()},250),!E.value&&M())}),v(C,(a,e)=>{u.value||e&&!a&&A()});const z=()=>{const a=!u.value;if(u.value=a,a){M();return}!C.value&&!V.value&&A()},F=y(()=>[...s.sortedAlerts].reverse());return(a,e)=>(h(),b(U,null,[o("div",{class:w(["flex",{"pointer-events-none":l(c).editingMode}])},[o("div",{class:w(["mx-1 my-1.5 w-[500px] rounded-md",{"alert-border-blink":k.value}]),style:te(l(r).options.enableColorCoding?$.value:"border: none;")},[o("div",{ref_key:"currentAlertBar",ref:T,class:w(["flex items-center justify-between p-1 overflow-hidden rounded cursor-pointer select-none whitespace-nowrap",k.value?"bg-[#db151233]":"bg-slate-800/75"])},[o("p",ce,p(d.value.message),1),o("div",ue,[o("p",null,p(_(d.value.time_created||new Date)),1),o("p",null,p(d.value.level.toUpperCase()),1)])],2),o("div",{ref_key:"expandedAlertsBar",ref:W,class:w(["expanded-alerts-bar absolute w-full p-2 transition-all rounded top-12 max-h-[30vh] overflow-y-auto text-slate-50 scrollbar-hide bg-slate-800/75 select-none flex flex-col",{"opacity-0 invisible":!l(E)}])},[(h(!0),b(U,null,se(F.value,(t,R)=>(h(),b("div",{key:t.time_created.toISOString()},[o("div",{title:t.message,class:"flex items-center justify-between whitespace-nowrap"},[o("p",pe,p(t.message),1),o("div",ve,[o("p",null,p(_(t.time_created||new Date)),1),o("p",null,p(t.level.toUpperCase()),1)])],8,me),R!==l(s).alerts.length-1?(h(),b("div",fe)):oe("",!0)]))),128))],2)],6),m(j,{icon:"mdi-arrow-vertical-lock",variant:"text",color:u.value?"orange ":"white",class:"-mr-6 -ml-4 mt-[2px] bg-transparent",onClick:e[0]||(e[0]=t=>z())},null,8,["color"])],2),m(ne,{modelValue:l(c).miniWidgetManagerVars(l(r).hash).configMenuOpen,"onUpdate:modelValue":e[5]||(e[5]=t=>l(c).miniWidgetManagerVars(l(r).hash).configMenuOpen=t),title:"Alerter options","max-width":"400px",variant:"text-only"},{content:S(()=>[o("div",xe,[m(H,{modelValue:l(r).options.enableColorCoding,"onUpdate:modelValue":e[1]||(e[1]=t=>l(r).options.enableColorCoding=t),"hide-details":"",label:"Enable color coded alerts",color:"white"},null,8,["modelValue"]),m(H,{modelValue:l(s).enableVoiceAlerts,"onUpdate:modelValue":e[2]||(e[2]=t=>l(s).enableVoiceAlerts=t),"hide-details":"",label:"Enable voice alerts",color:"white"},null,8,["modelValue"]),m(ae,{modelValue:l(s).alertVolume,"onUpdate:modelValue":e[3]||(e[3]=t=>l(s).alertVolume=t),min:"0",max:"1",step:"0.05","hide-details":"","thumb-label":"",label:"Alert volume",color:"white",class:"w-[250px] mt-2",disabled:!l(s).enableVoiceAlerts},null,8,["modelValue","disabled"])])]),actions:S(()=>[m(j,{onClick:e[4]||(e[4]=t=>l(c).miniWidgetManagerVars(l(r).hash).configMenuOpen=!1)},{default:S(()=>e[6]||(e[6]=[re("Close")])),_:1,__:[6]})]),_:1},8,["modelValue"])],64))}}),we=ie(be,[["__scopeId","data-v-3c95a49a"]]);export{we as default};
