import{c as B,J as U,r as f,o as L,w,l as O,I,n as g,a0 as j,b0 as q,am as Y,y as G,M as J,Y as X,u as K,L as Q,aN as Z,k as C,aR as ee,aS as d,b1 as te,aP as M,aM as ae,aT as se,m as oe,H as V,N as ne,an as le,q as c,F as ie,_ as re}from"./index-DA_DYss9.js";import{g as h}from"./index-DaYL4gH5.js";const de=B({__name:"Dialog",props:{show:Boolean},emits:["update:show"],setup(u,{emit:v}){const p=u,k=v,r=U(p).show,n=f(r.value),i=f(),m=f();return L(()=>{i.value.addEventListener("click",a=>{!a.target||a.target instanceof HTMLElement&&!a.target.closest(".action-button")&&a.target.nodeName!=="DIALOG"||(n.value=!1)}),document.addEventListener("keydown",a=>{n.value&&a.key==="Escape"&&(a.preventDefault(),a.stopImmediatePropagation(),n.value=!1)},{passive:!1})}),w(r,()=>n.value=r.value),w(n,()=>{n.value?i.value.showModal():(i.value.setAttribute("closing",""),i.value.addEventListener("animationend",()=>{i.value.removeAttribute("closing"),i.value.close()},{once:!0})),k("update:show",n.value)}),(a,s)=>(O(),I(Y,{to:"body"},[g("dialog",{ref_key:"dialogRef",ref:i,class:"modal"},[g("div",j({ref_key:"dialogContentRef",ref:m},a.$attrs,{class:"flex flex-col items-center justify-center w-full h-full p-5 backdrop-blur-sm"}),[q(a.$slots,"default")],16)],512)]))}}),ue=["height","width"],ce={class:"flex items-center"},ge={class:"w-40"};var H=(u=>(u.NORTH_UP="North Up",u.HEAD_UP="Head Up",u))(H||{});const fe=B({__name:"Compass",props:{widget:{}},setup(u){const v=G();J.registerUsage(X.heading);const p=K(),k=f(),r=f(),n=f(),i={0:"N",45:"NE",90:"E",135:"SE",180:"S",225:"SW",270:"W",315:"NW"},m=Object.values(H),s=U(u).widget;Q(()=>{Object.keys(s.value.options).length===0&&(s.value.options={headingStyle:m[0]})}),L(()=>{P(),E()});const{width:$,height:z}=Z(),T=C(()=>s.value.size.width*$.value),R=C(()=>s.value.size.height*z.value),y=C(()=>T.value<R.value?T.value:R.value),E=()=>{if(r.value===void 0||r.value===null)return;n.value===void 0&&(n.value=r.value.getContext("2d"));const e=n.value;ee(e);const t=.5*y.value,l=.13*y.value,D=.03*t;e.textAlign="center",e.strokeStyle="white",e.font=`bold ${l}px Arial`,e.fillStyle="white",e.lineWidth=D,e.textBaseline="middle";const x=.7*t,N=.4*t,W=.55*t;e.translate(t,t),e.font=`bold ${l}px Arial`,e.fillText(`${o.yawAngleDegrees.toFixed(0)}Â°`,.15*l,0),e.rotate(d(-90)),s.value.options.headingStyle=="Head Up"&&e.rotate(-d(o.yawAngleDegrees));for(const[_,F]of Object.entries(i))e.save(),e.rotate(d(Number(_))),e.beginPath(),e.moveTo(W,0),e.lineTo(x,0),e.textBaseline="bottom",e.font=`bold ${.7*l}px Arial`,e.translate(x*1.025,0),e.rotate(d(90)),e.fillText(F,0,0),e.stroke(),e.restore();for(const _ of te(360))_%9===0&&(e.save(),e.lineWidth=.25*D,e.rotate(d(Number(_))),e.beginPath(),e.moveTo(1.1*W,0),e.lineTo(x,0),e.stroke(),e.restore());e.beginPath(),e.arc(0,0,x,0,d(360)),e.stroke(),s.value.options.headingStyle=="North Up"?e.rotate(d(o.yawAngleDegrees)):e.rotate(d(o.yawAngleDegrees)),e.beginPath(),e.lineWidth=1,e.strokeStyle="red",e.fillStyle="red";const S=.05*t;e.moveTo(N,S),e.lineTo(W-.5*S,0),e.lineTo(N,-S),e.lineTo(N,S),e.closePath(),e.fill(),e.stroke()},b=f(.01);let A;w(p.attitude,e=>{if(A===void 0){b.value=M(p.attitude.yaw),A=e.yaw;return}Math.abs(M(e.yaw-A))>.1&&(A=e.yaw,b.value=M(p.attitude.yaw))});const o=ae({yawAngleDegrees:0}),P=()=>{const e=b.value,t=e<0?e+360:e,l=o.yawAngleDegrees>270&&t<90,D=o.yawAngleDegrees<90&&t>270;l?(h.to(o,.05,{yawAngleDegrees:0}),h.fromTo(o,.05,{yawAngleDegrees:0},{yawAngleDegrees:t})):D?(h.to(o,.05,{yawAngleDegrees:360}),h.fromTo(o,.05,{yawAngleDegrees:360},{yawAngleDegrees:t})):h.to(o,.1,{yawAngleDegrees:t})};return w(b,()=>P()),w([o,T,R],()=>{v.isWidgetVisible(s.value)&&se(()=>E())}),(e,t)=>(O(),oe(ie,null,[g("div",{ref_key:"compassRoot",ref:k,class:"compass"},[g("canvas",{ref_key:"canvasRef",ref:r,height:y.value,width:y.value,class:"rounded-[15%] bg-slate-950/70"},null,8,ue)],512),V(de,{show:c(v).widgetManagerVars(c(s).hash).configMenuOpen,"onUpdate:show":t[1]||(t[1]=l=>c(v).widgetManagerVars(c(s).hash).configMenuOpen=l),class:"flex pa-4 bg-[#ffffff10] text-white backdrop-blur-2xl border-[1px] border-[#FAFAFA12]"},{default:ne(()=>[g("div",ce,[t[2]||(t[2]=g("span",{class:"mr-3 text-slate-100"},"Heading style",-1)),g("div",ge,[V(le,{modelValue:c(s).options.headingStyle,"onUpdate:modelValue":t[0]||(t[0]=l=>c(s).options.headingStyle=l),options:c(m)},null,8,["modelValue","options"])])])]),_:1},8,["show"])],64))}}),he=re(fe,[["__scopeId","data-v-758f6fd3"]]);export{he as default};
